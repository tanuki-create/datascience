# Best Time to Buy and Sell Stock - ロジック解説

## 問題概要

株価の配列が与えられたとき、1回の取引で得られる最大利益を求める。

**制約**:
- `1 <= prices.length <= 10^5`

**例**:
```
Input: prices = [7,1,5,3,6,4]
Output: 5
説明: 2日目に買い(1)、5日目に売り(6) → 利益5
```

## ロジックの核心

### なぜ貪欲法が有効か？

**全探索（O(n²)）**:
- 全ての買い/売りの組み合わせを試す
- 時間計算量: O(n²) - 非効率

**貪欲法を使う理由**:
- **局所最適選択**: 各時点で最安値で買い、最高値で売る
- **1回の走査**: 過去の最安値を追跡しながら、各時点での最大利益を計算
- **時間計算量**: O(n) - 線形時間で効率的

### 思考プロセス

1. **最安値の追跡**: これまでに見た最安値を保持
2. **利益の計算**: 各時点で売った場合の利益を計算
3. **最大利益の更新**: 計算した利益の最大値を更新

### アルゴリズムのステップ

```
1. min_price = prices[0], max_profit = 0 を初期化
2. i = 1 から n-1 まで:
   a. min_price = min(min_price, prices[i])
   b. profit = prices[i] - min_price
   c. max_profit = max(max_profit, profit)
3. max_profit を返す
```

## 具体例でのトレース

### 例: `prices = [7,1,5,3,6,4]`

| i | prices[i] | min_price | profit | max_profit |
|---|-----------|-----------|--------|------------|
| 0 | 7 | 7 | - | 0 |
| 1 | 1 | 1 | - | 0 |
| 2 | 5 | 1 | 4 | 4 |
| 3 | 3 | 1 | 2 | 4 |
| 4 | 6 | 1 | 5 | 5 |
| 5 | 4 | 1 | 3 | 5 |

**結果**: `5`

## 現実世界での応用

### 1. 金融取引システム
- **シナリオ**: リアルタイムで最適な売買タイミングを決定
- **実装**: 同様の貪欲法で最大利益を計算

### 2. 在庫管理
- **シナリオ**: 商品の価格変動から最適な購入/販売タイミングを決定
- **実装**: 価格データから最大利益を計算

## 注意点と落とし穴

1. **買いが売りより後**: 必ず買ってから売る必要がある
2. **利益が負の場合**: 利益が出ない場合は0を返す
3. **単調減少**: 価格が単調減少する場合は0を返す

## 関連問題

- Best Time to Buy and Sell Stock II（複数回取引可能）
- Best Time to Buy and Sell Stock III（最大2回取引）

---

**次のステップ**: [Maximum Subarray](./maximum_subarray_logic.md)でKadane's Algorithmを学ぶ

